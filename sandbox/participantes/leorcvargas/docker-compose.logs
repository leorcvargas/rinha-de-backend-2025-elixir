
#1 [internal] load local bake definitions
#1 reading from stdin 979B done
#1 DONE 0.0s

#2 [api2 internal] load build definition from Dockerfile
#2 transferring dockerfile: 1.31kB done
#2 DONE 0.0s

#3 [api2 internal] load metadata for docker.io/hexpm/elixir:1.18.4-erlang-26.2.5.14-debian-bookworm-20250721-slim
#3 DONE 0.2s

#4 [api2 internal] load metadata for docker.io/library/debian:bookworm-20250721-slim
#4 DONE 0.2s

#5 [api1 internal] load .dockerignore
#5 transferring context: 1.31kB done
#5 DONE 0.0s

#6 [api2 builder  1/15] FROM docker.io/hexpm/elixir:1.18.4-erlang-26.2.5.14-debian-bookworm-20250721-slim@sha256:ecc39765d612ebc9a26f218df95c8bab9156b858b0cf296e4f4fd0f73a190568
#6 DONE 0.0s

#7 [api2 stage-1 1/6] FROM docker.io/library/debian:bookworm-20250721-slim@sha256:2424c1850714a4d94666ec928e24d86de958646737b1d113f5b2207be44d37d8
#7 DONE 0.0s

#8 [api2 internal] load build context
#8 transferring context: 3.47kB 0.0s done
#8 transferring context: 3.47kB 0.0s done
#8 DONE 0.1s

#9 [api2 builder  2/15] RUN apt-get update -y && apt-get install -y --no-install-recommends   build-essential git ca-certificates   && rm -rf /var/lib/apt/lists/*
#9 CACHED

#10 [api2 builder  4/15] RUN mix local.hex --force && mix local.rebar --force
#10 CACHED

#11 [api2 builder  6/15] RUN mix deps.get --only prod
#11 CACHED

#12 [api2 builder  9/15] RUN mix deps.compile
#12 CACHED

#13 [api2 builder  5/15] COPY mix.exs mix.lock ./
#13 CACHED

#14 [api2 builder  3/15] WORKDIR /app
#14 CACHED

#15 [api2 builder  7/15] RUN mkdir config
#15 CACHED

#16 [api2 builder  8/15] COPY config/config.exs config/prod.exs config/
#16 CACHED

#17 [api2 builder 10/15] COPY priv priv
#17 CACHED

#18 [api2 builder 11/15] COPY lib  lib
#18 DONE 0.1s

#19 [api1 builder 12/15] RUN mix compile
#19 1.749 Compiling 11 files (.ex)
#19 2.040 Generated rinhex app
#19 DONE 2.3s

#20 [api1 builder 13/15] COPY config/runtime.exs config/
#20 DONE 0.1s

#21 [api1 builder 14/15] COPY rel rel
#21 DONE 0.0s

#22 [api1 builder 15/15] RUN mix release
#22 1.500 * assembling rinhex-0.1.0 on MIX_ENV=prod
#22 1.507 * using config/runtime.exs to configure the release at runtime
#22 1.765 * skipping elixir.bat for windows (bin/elixir.bat not found in the Elixir installation)
#22 1.765 * skipping iex.bat for windows (bin/iex.bat not found in the Elixir installation)
#22 2.129 
#22 2.129 Release created at _build/prod/rel/rinhex
#22 2.129 
#22 2.129     # To start your system
#22 2.129     _build/prod/rel/rinhex/bin/rinhex start
#22 2.129 
#22 2.129 Once the release is running:
#22 2.129 
#22 2.129     # To connect to it remotely
#22 2.129     _build/prod/rel/rinhex/bin/rinhex remote
#22 2.129 
#22 2.129     # To stop it gracefully (you may also send SIGINT/SIGTERM)
#22 2.129     _build/prod/rel/rinhex/bin/rinhex stop
#22 2.129 
#22 2.129 To list all commands:
#22 2.129 
#22 2.129     _build/prod/rel/rinhex/bin/rinhex
#22 2.129 
#22 DONE 2.2s

#23 [api1 stage-1 2/6] RUN apt-get update -y && apt-get install -y --no-install-recommends   tini libstdc++6 libncurses6 openssl ca-certificates   && rm -rf /var/lib/apt/lists/*
#23 CACHED

#24 [api1 stage-1 3/6] WORKDIR /app
#24 CACHED

#23 [api2 stage-1 2/6] RUN apt-get update -y && apt-get install -y --no-install-recommends   tini libstdc++6 libncurses6 openssl ca-certificates   && rm -rf /var/lib/apt/lists/*
#23 CACHED

#24 [api2 stage-1 3/6] WORKDIR /app
#24 CACHED

#25 [api1 stage-1 4/6] COPY --from=builder /app/_build/prod/rel/rinhex ./
#25 DONE 0.2s

#26 [api2 stage-1 5/6] COPY entrypoint.sh /entrypoint.sh
#26 DONE 0.0s

#27 [api1 stage-1 6/6] RUN chmod +x /entrypoint.sh
#27 DONE 0.2s

#28 [api1] exporting to image
#28 exporting layers
#28 exporting layers 0.3s done
#28 writing image sha256:32b02aa9a6ed8dcb0259c8102fe0450ba0d97854353125c5c9db65f474c116f7 done
#28 naming to docker.io/library/leorcvargas-api1 done
#28 DONE 0.4s

#29 [api2] exporting to image
#29 exporting layers 0.3s done
#29 writing image sha256:931aa20d3e3309dc58ca851da694a037c44888a961ee04fbaa34a4f7a7c37621 done
#29 naming to docker.io/library/leorcvargas-api2 done
#29 DONE 0.4s

#30 [api2] resolving provenance for metadata file
#30 DONE 0.0s

#31 [api1] resolving provenance for metadata file
#31 DONE 0.0s
 leorcvargas-api1  Built
 leorcvargas-api2  Built
 Network leorcvargas_rinhex  Creating
 Network leorcvargas_rinhex  Created
 Volume "leorcvargas_sockets"  Creating
 Volume "leorcvargas_sockets"  Created
 Container leorcvargas-api2-1  Creating
 Container leorcvargas-api1-1  Creating
 Container leorcvargas-api2-1  Created
 Container leorcvargas-api1-1  Created
 Container leorcvargas-loadbalancer-1  Creating
 Container leorcvargas-loadbalancer-1  Created
Attaching to api1-1, api2-1, loadbalancer-1
loadbalancer-1  | [NOTICE]   (1) : Initializing new worker (8)
loadbalancer-1  | [NOTICE]   (1) : Loading success.
api2-1          | 
api2-1          | 12:39:51.973 [info] Running RinhexWeb.HttpServer with Bandit 1.7.0 at /tmp/rinhex/api2.sock (http+unix)
api1-1          | 
api1-1          | 12:39:52.002 [info] Running RinhexWeb.HttpServer with Bandit 1.7.0 at /tmp/rinhex/api1.sock (http+unix)
api2-1          | 
api2-1          | 12:39:52.008 [info] [libcluster:gossip] connected to :rinhex@api1
loadbalancer-1  | [NOTICE]   (1) : haproxy version is 3.2.3-1844da7
loadbalancer-1  | [NOTICE]   (1) : path to executable is /usr/local/sbin/haproxy
loadbalancer-1  | [WARNING]  (1) : Exiting Master process...
loadbalancer-1  | [WARNING]  (8) : Proxy fe_http stopped (cumulated conns: FE: 559, BE: 0).
loadbalancer-1  | [WARNING]  (8) : Proxy be_api stopped (cumulated conns: FE: 0, BE: 16731).
loadbalancer-1  | [WARNING]  (1) : Current worker (8) exited with code 0 (Exit)
loadbalancer-1  | [WARNING]  (1) : All workers exited. Exiting... (0)
[Kloadbalancer-1 exited with code 0
api1-1          | 
api1-1          | 12:41:04.468 [notice] SIGTERM received - shutting down
api1-1          | 
api2-1          | 
api2-1          | 12:41:04.468 [notice] SIGTERM received - shutting down
api2-1          | 
[Kapi2-1 exited with code 0
log truncated at line 1000
